(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{i:()=>B}),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].reverse();var t=document.querySelector(".elements"),n=document.querySelector(".popup_zoom-picture"),o=document.querySelector(".popup__zoom-pic"),r=document.querySelector(".popup__zoom-title"),c=document.querySelector(".popup_form_edit-profile"),u=document.querySelector(".popup_form_new-place"),a=document.querySelector(".popup_profile-edit"),s=document.querySelector(".profile__photo"),i=document.querySelector(".profile__name"),l=document.querySelector(".profile__description"),d=document.querySelector("#name"),p=document.querySelector("#description"),m=document.querySelector(".popup_place-add"),f=document.querySelector(".popup_form_new-place"),_=document.querySelector(".page"),v=Array.from(document.querySelectorAll(".popup")),y=document.querySelector(".popup_edit_avatar"),h=document.querySelector("#avatar-url"),S=document.querySelector(".popup__item_el_place-name"),q=document.querySelector(".popup__item_el_place-url"),b=document.querySelector("#new-mesto").content,k=Array.from(document.querySelectorAll(".spinner")),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;t?(e.classList.remove(n.inactiveButtonClass),e.disabled=!1):(e.classList.add(n.inactiveButtonClass),e.disabled="disabled")},E={url:"https://mesto.nomoreparties.co/plus-cohort-13",urlLikes:"https://nomoreparties.co/v1/plus-cohort-13/cards/likes",headers:{"Content-Type":"application/json",Authorization:"5f5f6516-2c69-4593-ad66-9a5c627fc536"}},L=function(e){return e.ok?e.json():Promise.reject(e)};function C(){return fetch("".concat(E.url,"/users/me"),{headers:E.headers}).then(L)}function x(e){e.classList.add("popup_opened"),_.addEventListener("keydown",j)}function A(e){e.classList.remove("popup_opened"),_.removeEventListener("keydown",j)}function j(e){"Escape"===e.key&&A(document.querySelector(".popup_opened"))}function M(e,t,n){e.textContent=t?"Сохранение...":n}function w(e,t){var n=e.querySelector(".mesto__button");e.querySelector(".mesto__likes").textContent=t.length,function(e){return Boolean(e.find((function(e){return e._id===B})))}(t)?n.classList.add("mesto__button_active"):n.classList.remove("mesto__button_active")}function P(e,t){e.prepend(t)}function O(e){var t=b.querySelector(".mesto").cloneNode(!0),c=t.querySelector(".mesto__image"),u=t.querySelector(".mesto__button");return t.querySelector(".mesto__title").textContent=e.name,c.src=e.link,c.alt=e.name,w(t,e.likes),c.addEventListener("click",(function(){x(n),o.src=e.link,r.textContent=e.name,o.alt=e.name})),u.addEventListener("click",(function(){!function(e,t,n){(function(e,t){return fetch("".concat(E.urlLikes,"/").concat(e),{method:t?"DELETE":"PUT",headers:E.headers}).then(L)})(e,t).then((function(e){return w(n,e.likes)})).catch((function(e){return console.log("При установке лайка произошла ошибка: ".concat(e))}))}(e._id,u.classList.contains("mesto__button_active"),t)})),function(e,t){var n=t.querySelector(".mesto__delete");if(e.owner._id!==B)return n.remove();t.querySelector(".mesto__delete").addEventListener("click",(function(){var n;'"_id": "'.concat(e._id,'"'),(n=e._id,fetch("".concat(E.url,"/cards/").concat(n),{method:"DELETE",headers:E.headers}).then(L)).then((function(){return t.remove()})).catch((function(e){return console.log("При удалении карточки что-то пошло не так: ".concat(e))}))}))}(e,t),t}var T,B=null;function D(e){e?k.forEach((function(e){e.classList.add("spinner_visible")})):k.forEach((function(e){e.classList.remove("spinner_visible")}))}D(!0),Promise.all([C(),fetch("".concat(E.url,"/cards"),{headers:E.headers}).then(L)]).then((function(e){i.textContent=e[0].name,l.textContent=e[0].about,s.src=e[0].avatar,B=e[0]._id,e[1].forEach((function(e){P(t,O(e))}))})).catch((function(e){return console.log("Что-то пошло не так: ".concat(e))})).finally((function(){return D(!1)})),T={formSelector:".popup__container",inputSelector:".popup__item",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_state_inactive",inputErrorClass:"popup__item_state_invalid",customMessages:{urlMismatch:"Введите адрес сайта",missedInput:"Вы пропустили это поле"}},Array.from(document.querySelectorAll(T.formSelector)).forEach((function(e){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(n){n.addEventListener("input",(function(){!function(e,t,n){e.setCustomValidity("");var o=e.validity.valid,r=t.querySelector("#".concat(e.id,"-error"));!function(e,t){"url"!==e.type&&!e.validity.valueMissing||e.validity.valid||(e.validity.valueMissing?e.setCustomValidity(t.customMessages.missedInput):e.setCustomValidity(t.customMessages.urlMismatch))}(e,n),o?function(e,t,n){t.classList.remove(n.inputErrorClass),e.textContent=t.validationMessage}(r,e,n):function(e,t,n){t.classList.add(n.inputErrorClass),e.textContent=t.validationMessage}(r,e,n)}(n,e,t),g(o,e.checkValidity(),t)}))})),e.addEventListener("submit",(function(e){e.preventDefault(),g(o,!1,t)}))}(e,T)})),document.querySelector(".profile__edit-button").addEventListener("click",(function(){var e;x(c),e=c,Array.from(e.querySelectorAll(".popup__item-error")).forEach((function(e){e.textContent=""})),d.value=i.textContent,p.value=l.textContent})),document.querySelector(".profile__add-button").addEventListener("click",(function(){x(u)})),a.addEventListener("submit",(function(e){var t=a.querySelector(".popup__button_status_save");e.preventDefault(),M(t,!0,""),function(){var e,t=a.querySelector(".popup__button_status_save");(e={name:d.value,about:p.value},fetch("".concat(E.url,"/users/me"),{method:"PATCH",headers:E.headers,body:JSON.stringify(e)}).then(L)).then((function(){C().then((function(e){i.textContent=e.name,l.textContent=e.about,A(c)}))})).catch((function(e){return console.log("При редактировании профиля что-то пошло не так: ".concat(e))})).finally((function(){return M(t,!1,"Сохранить")}))}()})),m.addEventListener("submit",(function(e){var n=m.querySelector(".popup__button_status_create");e.preventDefault(),M(n,!0,""),function(){var e,n=m.querySelector(".popup__button_status_create");(e={link:q.value,name:S.value},fetch("".concat(E.url,"/cards"),{method:"POST",headers:E.headers,body:JSON.stringify(e)}).then(L)).then((function(e){P(t,O(e)),A(f)})).catch((function(e){return console.log("С добавлением карточки что-то не так: ".concat(e))})).finally((function(){return M(n,!1,"Создать")})),q.value="",S.value=""}()})),v.forEach((function(e){e.addEventListener("mousedown",(function(t){t.target.classList.contains("popup_opened")&&A(e),t.target.classList.contains("popup__button_status_close")&&A(e)}))})),document.querySelector(".profile__avatar-button").addEventListener("click",(function(){x(y)})),y.querySelector(".popup_avatar_add").addEventListener("submit",(function(e){var t=y.querySelector(".popup__button_status_save");e.preventDefault(),M(t,!0,""),function(){var e,t=y.querySelector(".popup__button_status_save");(e={avatar:h.value},fetch("".concat(E.url,"/users/me/avatar"),{method:"PATCH",headers:E.headers,body:JSON.stringify(e)}).then(L)).then((function(){C().then((function(e){s.src=e.avatar})).catch((function(e){return console.log("При получении обновленных данных профиля что-то пошло не так: ".concat(e))})),A(y)})).catch((function(e){return console.log("При редактировании аватара профиля что-то пошло не так: ".concat(e))})).finally((function(){return M(t,!1,"Сохранить")}))}()}))})();