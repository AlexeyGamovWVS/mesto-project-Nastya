(()=>{"use strict";var e={d:(t,n)=>{for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};e.d({},{i:()=>P}),[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}].reverse();var t=document.querySelector(".elements"),n=document.querySelector(".popup_zoom-picture"),o=document.querySelector(".popup__zoom-pic"),r=document.querySelector(".popup__zoom-title"),c=document.querySelector(".popup_form_edit-profile"),u=document.querySelector(".popup_form_new-place"),a=document.querySelector(".popup_profile-edit"),s=document.querySelector(".profile__photo"),i=document.querySelector(".profile__name"),l=document.querySelector(".profile__description"),p=document.querySelector("#name"),d=document.querySelector("#description"),_=document.querySelector(".popup_place-add"),m=document.querySelector(".popup_form_new-place"),f=document.querySelector(".page"),v=Array.from(document.querySelectorAll(".popup")),y=document.querySelector(".popup_edit_avatar"),h=document.querySelector("#avatar-url"),S=document.querySelector(".popup__item_el_place-name"),q=document.querySelector(".popup__item_el_place-url"),b=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2?arguments[2]:void 0;t?(e.classList.remove(n.inactiveButtonClass),e.disabled=!1):(e.classList.add(n.inactiveButtonClass),e.disabled="disabled")},k={url:"https://mesto.nomoreparties.co/plus-cohort-13",urlLikes:"https://nomoreparties.co/v1/plus-cohort-13/cards/likes",headers:{"Content-Type":"application/json",Authorization:"5f5f6516-2c69-4593-ad66-9a5c627fc536"}},E=function(e){return e.ok?e.json():Promise.reject(e)};function L(){return fetch("".concat(k.url,"/users/me"),{headers:k.headers}).then(E)}function g(e){e.classList.add("popup_opened"),f.addEventListener("keydown",x)}function C(e){e.classList.remove("popup_opened"),f.removeEventListener("keydown",x)}function x(e){"Escape"===e.key&&C(document.querySelector(".popup_opened"))}function j(e,t,n){e.textContent=t?"Сохранение...":n}function A(e,t){var n=e.querySelector(".mesto__button");e.querySelector(".mesto__likes").textContent=t.length,function(e){return Boolean(e.find((function(e){return e._id===P})))}(t)?n.classList.add("mesto__button_active"):n.classList.remove("mesto__button_active")}function M(e,t){e.prepend(t)}function w(e){var t=document.querySelector("#new-mesto").content.querySelector(".mesto").cloneNode(!0),c=t.querySelector(".mesto__image"),u=t.querySelector(".mesto__button");return t.querySelector(".mesto__title").textContent=e.name,c.src=e.link,c.alt=e.name,A(t,e.likes),c.addEventListener("click",(function(){g(n),o.src=e.link,r.textContent=e.name,o.alt=e.name})),u.addEventListener("click",(function(){!function(e,t,n){(function(e,t){return fetch("".concat(k.urlLikes,"/").concat(e),{method:t?"DELETE":"PUT",headers:k.headers}).then(E)})(e,t).then((function(e){return A(n,e.likes)})).catch((function(e){return console.log("При установке лайка произошла ошибка: ".concat(e))}))}(e._id,u.classList.contains("mesto__button_active"),t)})),function(e,t){var n=t.querySelector(".mesto__delete");if(e.owner._id!==P)return n.remove();t.querySelector(".mesto__delete").addEventListener("click",(function(){var n;'"_id": "'.concat(e._id,'"'),(n=e._id,fetch("".concat(k.url,"/cards/").concat(n),{method:"DELETE",headers:k.headers}).then(E)).then((function(){return t.remove()})).catch((function(e){return console.log("При удалении карточки что-то пошло не так: ".concat(e))}))}))}(e,t),t}var O,P=null;L().then((function(e){i.textContent=e.name,l.textContent=e.about,s.src=e.avatar,P=e._id})).catch((function(e){return console.log("С данными профиля что-то не так: ".concat(e))})),fetch("".concat(k.url,"/cards"),{headers:k.headers}).then(E).then((function(e){e.forEach((function(e){M(t,w(e))}))})).catch((function(e){return console.log("При рендере карточек что-то пошло не так: ".concat(e))})),O={formSelector:".popup__container",inputSelector:".popup__item",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_state_inactive",inputErrorClass:"popup__item_state_invalid",customMessages:{urlMismatch:"Введите адрес сайта",missedInput:"Вы пропустили это поле"}},Array.from(document.querySelectorAll(O.formSelector)).forEach((function(e){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=e.querySelector(t.submitButtonSelector);n.forEach((function(n){n.addEventListener("input",(function(){!function(e,t,n){e.setCustomValidity("");var o=e.validity.valid,r=t.querySelector("#".concat(e.id,"-error"));!function(e,t){"url"!==e.type&&!e.validity.valueMissing||e.validity.valid||(e.validity.valueMissing?e.setCustomValidity(t.customMessages.missedInput):e.setCustomValidity(t.customMessages.urlMismatch))}(e,n),o?function(e,t,n){t.classList.remove(n.inputErrorClass),e.textContent=t.validationMessage}(r,e,n):function(e,t,n){t.classList.add(n.inputErrorClass),e.textContent=t.validationMessage}(r,e,n)}(n,e,t),b(o,e.checkValidity(),t)}))})),e.addEventListener("submit",(function(e){e.preventDefault(),b(o,!1,t)}))}(e,O)})),n.querySelector(".popup__button_status_zoom-close").addEventListener("click",(function(){C(n)})),document.querySelector(".profile__edit-button").addEventListener("click",(function(){var e;g(c),e=c,Array.from(e.querySelectorAll(".popup__item-error")).forEach((function(e){e.textContent=""})),p.value=i.textContent,d.value=l.textContent})),c.querySelector(".popup__button_status_close").addEventListener("click",(function(){C(c)})),document.querySelector(".profile__add-button").addEventListener("click",(function(){g(u)})),u.querySelector(".popup__button_status_close").addEventListener("click",(function(){C(u)})),a.addEventListener("submit",(function(e){var t=a.querySelector(".popup__button_status_save");e.preventDefault(),j(t,!0,""),function(){var e,t=a.querySelector(".popup__button_status_save");(e={name:p.value,about:d.value},fetch("".concat(k.url,"/users/me"),{method:"PATCH",headers:k.headers,body:JSON.stringify(e)}).then(E)).then((function(){L().then((function(e){i.textContent=e.name,l.textContent=e.about}))})),j(t,!1,"Сохранить"),C(c)}()})),_.addEventListener("submit",(function(e){var n=_.querySelector(".popup__button_status_create");e.preventDefault(),j(n,!0,""),function(){var e,n=_.querySelector(".popup__button_status_create");(e={link:q.value,name:S.value},fetch("".concat(k.url,"/cards"),{method:"POST",headers:k.headers,body:JSON.stringify(e)}).then(E)).then((function(e){M(t,w(e))})).catch((function(e){return console.log("С добавлением карточки что-то не так: ".concat(e))})),j(n,!1,"Создать"),q.value="",S.value="",C(m)}()})),v.forEach((function(e){e.addEventListener("mousedown",(function(e){document.querySelector(".popup_opened")&&e.target.classList.contains("popup")&&C(e.target.closest(".popup_opened"))}))})),document.querySelector(".profile__avatar-button").addEventListener("click",(function(){g(y)})),y.querySelector(".popup__button_status_close").addEventListener("click",(function(){C(y)})),y.querySelector(".popup_avatar_add").addEventListener("submit",(function(e){var t=y.querySelector(".popup__button_status_save");e.preventDefault(),j(t,!0,""),function(){var e,t=y.querySelector(".popup__button_status_save");(e={avatar:h.value},fetch("".concat(k.url,"/users/me/avatar"),{method:"PATCH",headers:k.headers,body:JSON.stringify(e)}).then(E)).then((function(){L().then((function(e){s.src=e.avatar}))})),j(t,!1,"Сохранить"),C(y)}()}))})();